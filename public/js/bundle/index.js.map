{"mappings":"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","sources":["public/js/mapbox.js","public/js/alerts.js","public/js/login.js","public/js/updateSettings.js","public/js/stripe.js","public/js/index.js"],"sourcesContent":["/* eslint-disable */\nexport const displayMap = locations => {\n    mapboxgl.accessToken =\n        'pk.eyJ1IjoieWFzaGd1cHRhMTExMSIsImEiOiJjbGNjZzB2ZDUyazhwM3d0OHF0ZnhtcmhkIn0.S93xXiysZdlPuelZHk1Wdw';\n\n    var map = new mapboxgl.Map({\n        container: 'map',\n        style: 'mapbox://styles/yashgupta1111/clcci2fmq002p14p2o4z1kvxy',\n        scrollZoom: false\n    });\n\n    const bounds = new mapboxgl.LngLatBounds();\n\n    locations.forEach(loc => {\n        // Create marker\n        const el = document.createElement('div');\n        el.className = 'marker';\n\n        // Add marker\n        new mapboxgl.Marker({\n            element: el,\n            anchor: 'bottom'\n        })\n            .setLngLat(loc.coordinates)\n            .addTo(map);\n\n        // Add popup\n        new mapboxgl.Popup({\n            offset: 30\n        })\n            .setLngLat(loc.coordinates)\n            .setHTML(`<p>Day ${loc.day}: ${loc.description}</p>`)\n            .addTo(map);\n\n        // Extend map bounds to include current location\n        bounds.extend(loc.coordinates);\n    });\n\n    map.fitBounds(bounds, {\n        padding: {\n            top: 200,\n            bottom: 150,\n            left: 100,\n            right: 100\n        }\n    });\n};\n","/* eslint-disable */\n\nexport const hideAlert = () => {\n    const el = document.querySelector('.alert');\n    if (el) el.parentElement.removeChild(el);\n};\n\n// type can be 'success' or 'error'\nexport const showAlert = (type, msg, time = 5) => {\n    hideAlert();\n    const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n    document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\n    window.setTimeout(hideAlert, time * 1000);\n};\n","/* eslint-disable */\n// import axios from 'axios';\nimport { showAlert } from './alerts';\n\nexport const login = async (email, password) => {\n    try {\n        const res = await axios({\n            method: 'POST',\n            url: '/api/v1/users/login',\n            data: {\n                email,\n                password\n            }\n        });\n        if (res.data.status === 'success') {\n            showAlert('success', 'Logged in successfully!');\n            window.setTimeout(() => {\n                location.assign('/');\n            }, 1500);\n        }\n    } catch (err) {\n        showAlert('error', err.response.data.message);\n    }\n};\n\nexport const logout = async () => {\n    try {\n        const res = await axios({\n            method: 'GET',\n            url: '/api/v1/users/logout'\n        });\n        if (res.data.status === 'success') {\n            // location.reload(true);\n\n            // my\n            showAlert('success', 'Logged out successfully!');\n            window.setTimeout(() => {\n                location.assign('/');\n            }, 1500);\n        }\n    } catch (err) {\n        showAlert('error', 'Error in logging out please try again!');\n    }\n};\n","/* eslint-disable */\n// import axios from 'axios';\nimport { showAlert } from './alerts';\n\n// type can be password or data\nexport const updateSettings = async (data, type) => {\n    let res;\n    try {\n        const url =\n            type === 'password'\n                ? '/api/v1/users/updateMyPassword'\n                : '/api/v1/users/updateMe';\n\n        res = await axios({\n            method: 'PATCH',\n            url,\n            data\n        });\n\n        if (res.data.status === 'success') {\n            showAlert('success', `${type.toUpperCase()} updated successfully!`);\n            if (type === 'photo') {\n                // note return also goes to catch block hence handle that case also\n                return res.data.data.updatedUser.photo;\n            }\n        }\n    } catch (err) {\n        if (type === 'photo' && res.data.status === 'success') {\n            return;\n        }\n        showAlert('errror', err.response.data.message);\n    }\n};\n","/* eslint-disable */\n// import axios from 'axios';\n// const stripe = Stripe(\n// 'pk_test_51MMH1cSCFIFH28nc81LgT8gYmaByQwiw8WKJebkBQGl3AVj6PMnGWSCfOUuBIMZIZKIegfGGkndDnrbCGh7pt6pg00u2RrwCsD'\n// );\nimport { showAlert } from './alerts';\n\nexport const bookTour = async tourId => {\n    try {\n        // get checkout session from API\n\n        // by default get method in axios\n        const response = await axios(\n            `/api/v1/bookings/checkout-session/${tourId}`\n        );\n\n        // await stripe.redirectToCheckout({\n        //     sessionId: response.data.session.id\n        // });\n\n        // we can also use directly url as it is given in response no need of stripe.redirecto function\n        window.setTimeout(() => {\n            location.assign(response.data.session.url);\n        }, 100);\n    } catch (err) {\n        console.log(err);\n        showAlert('error', err);\n    }\n};\n","/* eslint-disable */\n// import '@babel/polyfill';\nimport { displayMap } from './mapbox';\nimport { login, logout } from './login';\nimport { updateSettings } from './updateSettings';\nimport { bookTour } from './stripe';\nimport { showAlert } from './alerts';\n\n// DOM Elements\nconst mapBox = document.getElementById('map');\nconst loginForm = document.querySelector('.form--login');\nconst logoutBtn = document.querySelector('.nav__el--logout');\nconst dataForm = document.querySelector('.form-user-data');\nconst passwordForm = document.querySelector('.form-user-password');\nconst imageChange = document.querySelector('.form__upload');\nconst bookTourBTN = document.getElementById('book-tour');\nconst headAlertDataset = document.querySelector('body').dataset.alert;\n\n// DELEGATION\nif (mapBox) {\n    const locations = JSON.parse(\n        document.getElementById('map').dataset.locations\n    );\n    displayMap(locations);\n}\n\nif (loginForm) {\n    loginForm.addEventListener('submit', event => {\n        event.preventDefault();\n        const email = document.getElementById('email').value;\n        const password = document.getElementById('password').value;\n        login(email, password);\n    });\n}\n\nif (logoutBtn) {\n    logoutBtn.addEventListener('click', logout);\n}\n\n// without photo\nif (dataForm) {\n    dataForm.addEventListener('submit', event => {\n        event.preventDefault();\n        const name = document.getElementById('name').value;\n        const email = document.getElementById('email').value;\n        updateSettings({ name, email }, 'data');\n    });\n}\n\n// with photo and all data submit at once i.e name email photo\n//hence need to create form data object no need to change updateSettings\n// if (dataForm) {\n//     dataForm.addEventListener('submit', event => {\n//         event.preventDefault();\n//         const form = new FormData();\n//         form.append('name', document.getElementById('name').value);\n//         form.append('email', document.getElementById('email').value);\n//         form.append('photo', document.getElementById('photo').files[0]);\n//         updateSettings(form, 'data');\n//     });\n// };\n\nif (imageChange) {\n    imageChange.addEventListener('change', async event => {\n        event.preventDefault();\n        const form = new FormData();\n        form.append('photo', document.getElementById('photo').files[0]);\n\n        const newUserPhotoName = await updateSettings(form, 'photo');\n        if (newUserPhotoName) {\n            document\n                .querySelector('.nav__user-img')\n                .setAttribute('src', `/img/users/${newUserPhotoName}`);\n            document\n                .querySelector('.form__user-photo')\n                .setAttribute('src', `/img/users/${newUserPhotoName}`);\n        }\n    });\n}\n\nif (passwordForm) {\n    passwordForm.addEventListener('submit', async event => {\n        event.preventDefault();\n        document.querySelector('.btn--save-password').textContent =\n            'updating..';\n\n        const currentPassword = document.getElementById('password-current')\n            .value;\n        const password = document.getElementById('password').value;\n        const passwordConfirm = document.getElementById('password-confirm')\n            .value;\n        await updateSettings(\n            { currentPassword, password, passwordConfirm },\n            'password'\n        );\n\n        document.querySelector('.btn--save-password').textContent =\n            'SAVE PASSWORD';\n\n        document.getElementById('password-current').value = '';\n        document.getElementById('password').value = '';\n        document.getElementById('password-confirm').value = '';\n    });\n}\n\nif (bookTourBTN) {\n    bookTourBTN.addEventListener('click', event => {\n        event.target.textContent = 'Processing...';\n        // all can work same\n        // const tourId = document.getElementById('book-tour').dataset.tourId;\n        // const tourId = event.target.dataset.tourId;\n        const { tourId } = event.target.dataset; // destructuring way\n        bookTour(tourId);\n    });\n}\n\nif (headAlertDataset) {\n    showAlert('success', headAlertDataset, 20);\n}\n"],"names":["$97addd748cf1f29c$export$4c5dd147b21b9176","locations","mapboxgl","accessToken","map","Map","container","style","scrollZoom","bounds","LngLatBounds","forEach","loc","el","document","createElement","className","Marker","element","anchor","setLngLat","coordinates","addTo","Popup","offset","setHTML","day","description","extend","fitBounds","padding","top","bottom","left","right","$90f0e2f189a974a3$export$516836c6a9dfc573","querySelector","parentElement","removeChild","$90f0e2f189a974a3$export$de026b00723010c1","type","msg","time","markup","insertAdjacentHTML","window","setTimeout","$60683c5a205ba12c$export$596d806903d1f59e","async","email","password","axios","method","url","data","status","location","assign","err","response","message","$e3842be56786052e$export$f558026a994b6051","res","toUpperCase","updatedUser","photo","$dacfe66cb9dc8f35$export$8d5bdbf26681c0c2","tourId","session","console","log","$a822b7a7f97d1425$var$mapBox","getElementById","$a822b7a7f97d1425$var$loginForm","$a822b7a7f97d1425$var$logoutBtn","$a822b7a7f97d1425$var$dataForm","$a822b7a7f97d1425$var$passwordForm","$a822b7a7f97d1425$var$imageChange","$a822b7a7f97d1425$var$bookTourBTN","$a822b7a7f97d1425$var$headAlertDataset","dataset","alert","JSON","parse","addEventListener","event","preventDefault","value","name","form","FormData","append","files","newUserPhotoName","setAttribute","textContent","currentPassword","passwordConfirm","target"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}